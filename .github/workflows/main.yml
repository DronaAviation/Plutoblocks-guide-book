name: Release Guide Book Update

on:
  push:
    tags:
      - 'v*' # Triggers on tags like v1.0.0, v1.0.1-beta, etc.

permissions:
  contents: write

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Create Version and Zip
        run: |
          # 1. Create a version file using the tag name from the push
          echo "{\"tag\": \"${{ github.ref_name }}\", \"updated\": \"$(date)\"}" > version.json
          
          # 2. Zip the contents
          # We include the guide HTML, the assets, and the local @electron folder you copied
          # We exclude .git and .github folders to keep the file small
          zip -r guide.zip . -x "*.git*" ".github*" "node_modules/*"

      - name: Create Guide Release
        uses: softprops/action-gh-release@v2
        with:
          files: guide.zip
          name: Guide Book Update ${{ github.ref_name }}
          body: "Automated deployment for Guide Book version ${{ github.ref_name }}"
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
