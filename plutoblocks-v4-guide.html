<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PlutoBlocks V4 | Official X2 Technical Manual</title>
    <script src="./style.css"></script>
    <link href="./style.css" rel="stylesheet">
    <link href="./font-awesome-min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        
        :root {
            scroll-behavior: smooth;
            font-family: 'Inter', sans-serif;
        }

        body { background-color: #0f172a; color: #e2e8f0; }

        /* Navigation Highlighting */
        .sidebar-item {
            transition: all 0.2s ease;
            border-left: 3px solid transparent;
            color: #cbd5e1;
        }
        .sidebar-item:hover { background-color: #1e293b; color: #0ea5e9; }
        .sidebar-item.active {
            background-color: #1e3a8a;
            color: #0ea5e9;
            border-left-color: #0ea5e9;
            font-weight: 600;
        }

        /* Section Spacing and Scroll Offset */
        section { scroll-margin-top: 100px; }

        /* Block Visuals */
        .pb-block {
            display: inline-flex;
            align-items: center;
            padding: 6px 14px;
            border-radius: 4px 12px 12px 4px;
            color: white;
            font-weight: 700;
            font-size: 0.7rem;
            position: relative;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 4px;
        }
        .pb-block::before {
            content: '';
            position: absolute;
            left: -6px;
            top: 50%;
            transform: translateY(-50%);
            width: 10px;
            height: 10px;
            background: inherit;
            clip-path: circle(50% at 100% 50%);
        }

        /* Category Colors */
        .block-led { background-color: #A55B80; } 
        .block-function { background-color: #A55B5B; }
        .block-timer { background-color: #A5935B; } 
        .block-peripherals { background-color: #5BA58C; } 
        .block-command { background-color: #A55B5B; } 
        .block-motor { background-color: #5B6DA5; } 
        .block-remote { background-color: #A5935B; } 
        .block-sensor { background-color: #5B8CA5; } 
        .block-state { background-color: #825BA5; } 
        .block-desired { background-color: #A55B80; } 
        .block-mode { background-color: #5BA55B; } 
        .block-status { background-color: #A5805B; } 
        .block-logic { background-color: #5B80A5; } 
        .block-math { background-color: #5B67A5; }
        .block-var { background-color: #A55B5B; } 

        .info-card {
            background: #1e293b;
            border: 1px solid #334155;
            border-radius: 20px;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            height: 100%;
        }

        .label {
            font-size: 10px;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: #64748b;
        }

        .text-body { font-size: 13px; color: #cbd5e1; line-height: 1.5; }

        .use-case-box {
            background: #0f172a;
            border-radius: 12px;
            padding: 12px;
            margin-top: auto;
            border: 1px solid #1e3a8a;
        }

        .range-badge {
            background: #1e3a8a;
            color: #0ea5e9;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 11px;
        }

        ::-webkit-scrollbar { width: 5px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #1e3a8a; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #3b82f6; }
    </style>
</head>
<body class="text-slate-800">

    <div class="flex">
        <!-- Sidebar -->
        <aside id="sidebar" class="fixed top-0 left-0 h-screen w-72 bg-slate-900 border-r border-slate-700 z-50 overflow-y-auto transform -translate-x-full lg:translate-x-0 transition-transform duration-300">
            <div class="p-8">
                <div class="flex items-center gap-3 mb-10">
                    <div class="w-10 h-10 bg-blue-600 rounded-xl flex items-center justify-center shadow-lg">
                        <i class="fas fa-cube text-white"></i>
                    </div>
                    <div class="leading-tight">
                        <h1 class="text-lg font-extrabold tracking-tight text-slate-100">Pluto<span class="text-sky-400">Blocks</span></h1>
                        <p class="text-[10px] text-slate-500 font-bold uppercase tracking-widest">Master Guide V4</p>
                    </div>
                </div>

                <nav class="space-y-1">
                    <p class="text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-4 px-4">Categories</p>
                    <a href="#LED" class="sidebar-item block px-4 py-2 rounded-lg text-sm">1. LED</a>
                    <a href="#Function" class="sidebar-item block px-4 py-2 rounded-lg text-sm">2. Create Function</a>
                    <a href="#Timer" class="sidebar-item block px-4 py-2 rounded-lg text-sm">3. Timer</a>
                    <a href="#Peripheral" class="sidebar-item block px-4 py-2 rounded-lg text-sm">4. Peripheral</a>
                    <a href="#Command" class="sidebar-item block px-4 py-2 rounded-lg text-sm">5. Command</a>
                    <a href="#Motor" class="sidebar-item block px-4 py-2 rounded-lg text-sm">6. Motor</a>
                    <a href="#Remote" class="sidebar-item block px-4 py-2 rounded-lg text-sm">7. Remote Control</a>
                    <a href="#Sensor" class="sidebar-item block px-4 py-2 rounded-lg text-sm">8. Sensor</a>
                    <a href="#State" class="sidebar-item block px-4 py-2 rounded-lg text-sm">9. Current State</a>
                    <a href="#Desired" class="sidebar-item block px-4 py-2 rounded-lg text-sm">10. Desired State</a>
                    <a href="#Mode" class="sidebar-item block px-4 py-2 rounded-lg text-sm">11. Flight Mode</a>
                    <a href="#Status" class="sidebar-item block px-4 py-2 rounded-lg text-sm">12. Flight Status</a>
                    <a href="#Console" class="sidebar-item block px-4 py-2 rounded-lg text-sm">13. Console</a>
                    <a href="#Logic" class="sidebar-item block px-4 py-2 rounded-lg text-sm">14. Logic</a>
                    <a href="#Loops" class="sidebar-item block px-4 py-2 rounded-lg text-sm">15. Loops</a>
                    <a href="#Math" class="sidebar-item block px-4 py-2 rounded-lg text-sm">16. Math</a>
                    <a href="#Variables" class="sidebar-item block px-4 py-2 rounded-lg text-sm">17. Variables</a>
                </nav>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 lg:ml-72 min-h-screen">
            <header class="lg:hidden bg-slate-900 border-b border-slate-700 p-4 sticky top-0 z-40 flex justify-between items-center">
                <div class="font-bold text-slate-100">PlutoBlocks V4</div>
                <button id="menuBtn" class="p-2 text-slate-400"><i class="fas fa-bars text-xl"></i></button>
            </header>

            <div class="max-w-6xl mx-auto px-6 lg:px-12 py-16 space-y-32">
                
                <!-- 1. LED Control -->
                <section id="LED">
                    <h2 class="text-3xl font-black text-sky-400 mb-10">1. LED Control</h2>
                    
                    <div class="bg-gradient-to-r from-blue-950 to-slate-900 border border-blue-800 rounded-xl p-6 mb-12">
                        <p class="text-slate-200 leading-relaxed mb-4">
                            <span class="font-bold text-slate-100">PlutoBlocks for Primus X/V4, Primus X2 & Primus V5</span> include three programmable status LEDs that provide real-time visual feedback about your drone's state and operations.
                        </p>
                        <p class="text-slate-200 leading-relaxed mb-4">
                            This category contains powerful blocks to control all three LEDs independently, allowing you to set each one to <span class="font-semibold text-sky-400">ON</span>, <span class="font-semibold text-sky-400">OFF</span>, or <span class="font-semibold text-sky-400">TOGGLE</span> states based on your custom logic.
                        </p>
                        <div class="grid grid-cols-3 gap-4 mt-6 pt-4 border-t border-blue-800">
                            <div class="flex items-center gap-2">
                                <div class="w-3 h-3 rounded-full bg-red-500"></div>
                                <span class="text-sm font-medium text-slate-300">Red LED</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <div class="w-3 h-3 rounded-full bg-green-500"></div>
                                <span class="text-sm font-medium text-slate-300">Green LED</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <div class="w-3 h-3 rounded-full bg-blue-500"></div>
                                <span class="text-sm font-medium text-slate-300">Blue LED</span>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                        <div class="info-card">
                            <h3 class="font-bold">Red LED</h3>
                            <img src="gbassets/36.png" alt="Red LED Block" class="w-full h-24 object-contain rounded-lg mb-2">
                          
                            <div><span class="label">Function</span><p class="text-body">Sets the state (ON/OFF/Blink) of the Red LED.</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Real-time emergency warning system that activates on sensor fault, low battery threshold, or collision detection for immediate visual feedback.</p></div>
                        </div>
                        <div class="info-card">
                            <h3 class="font-bold">Green LED</h3>
                            <img src="gbassets/37.png" alt="Green LED Block" class="w-full h-24 object-contain rounded-lg mb-2">
                            <div><span class="label">Function</span><p class="text-body">Sets the state of the Green LED.</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Flight-ready status indicator that signals drone armed state, autonomous mission initialization, or successful system calibration completion.</p></div>
                        </div>
                        <div class="info-card">
                            <h3 class="font-bold">Blue LED</h3>
                            <img src="gbassets/38.png" alt="Blue LED Block" class="w-full h-24 object-contain rounded-lg mb-2">
                            <div><span class="label">Function</span><p class="text-body">Sets the state of the Blue LED.</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Network connectivity or telemetry link status display, sensor calibration phase indicator, or authentication state confirmation for secure operations.</p></div>
                        </div>
                    </div>
                </section>

                <!-- 2. Create Function -->
                <section id="Function">
                    <h2 class="text-3xl font-black text-sky-400 mb-10">2. Create Function</h2>
                    
                    <div class="bg-gradient-to-r from-blue-950 to-slate-900 border border-blue-800 rounded-xl p-6 mb-12">
                        <p class="text-slate-200 leading-relaxed mb-4">
                            <span class="font-bold text-slate-100">Create reusable code blocks</span> by grouping multiple PlutoBlocks into custom functions that can be called repeatedly throughout your program.
                        </p>
                        <p class="text-slate-200 leading-relaxed">
                            Functions help organize complex logic, reduce code duplication, and make your drone programs easier to maintain and debug. Define once, use everywhere.
                        </p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div class="info-card">
                            <h3 class="font-bold">Define Function</h3>
                            <div class="pb-block block-function">pluto_function_def</div>
                            <div><span class="label">Function</span><p class="text-body">Groups several blocks into a single named action.</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Modular safety validation routine that encapsulates battery health checks, RC signal verification, and sensor calibration into reusable custom logic.</p></div>
                        </div>
                        <div class="info-card">
                            <h3 class="font-bold">Call Function</h3>
                            <div class="pb-block block-function">pluto_function_call</div>
                            <div><span class="label">Function</span><p class="text-body">Executes the logic stored within a defined function.</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Execute recurring drone operations like safety pre-flight checks, state monitoring routines, or complex maneuvers repeatedly throughout autonomous missions.</p></div>
                        </div>
                        <div class="info-card md:col-span-2">
                            <h3 class="font-bold">Custom C++</h3>
                            <div class="pb-block block-function" style="background-color: #333;">pluto_custom_cpp</div>
                            <div><span class="label">Function</span><p class="text-body">Embed raw C++ code for advanced low-level tasks.</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Advanced drone algorithms, integration of existing flight libraries, real-time signal processing, or high-performance computational tasks beyond standard blocks.</p></div>
                        </div>
                    </div>
                </section>

                <!-- 3. Timer -->
                <section id="Timer">
                    <h2 class="text-3xl font-black text-sky-400 mb-10">3. Timer</h2>
                    
                    <div class="bg-gradient-to-r from-blue-950 to-slate-900 border border-blue-800 rounded-xl p-6 mb-12">
                        <p class="text-slate-200 leading-relaxed mb-4">
                            <span class="font-bold text-slate-100">Control timing and delays</span> in your drone programs using millisecond-precision timers for sequence management.
                        </p>
                        <p class="text-slate-200 leading-relaxed">
                            Set countdowns for specific actions, trigger events after delays, or create timed sequences. Perfect for landing delays, hover periods, or sensor data collection intervals.
                        </p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div class="info-card">
                            <h3 class="font-bold">Set Timer</h3>
                            <div class="pb-block block-timer">set_timer_x2</div>
                            <div><span class="label">Function</span><p class="text-body">Starts a millisecond countdown interval.</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Precise hover duration timing, sequential mission phase management, sensor data collection intervals, or timed flight pattern transitions.</p></div>
                        </div>
                        <div class="info-card">
                            <h3 class="font-bold">Timer Done?</h3>
                            <div class="pb-block block-timer">is_timer_done_x2</div>
                            <div><span class="label">Function</span><p class="text-body">Checks if the timer has reached zero.</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Time-triggered autonomous landings, mission phase completion detection, or sequential command execution based on elapsed duration thresholds.</p></div>
                        </div>
                    </div>
                </section>

                <!-- 4. Peripheral -->
                <section id="Peripheral">
                    <h2 class="text-3xl font-black text-sky-400 mb-10">4. Peripheral Control</h2>
                    
                    <div class="bg-gradient-to-r from-blue-950 to-slate-900 border border-blue-800 rounded-xl p-6 mb-12">
                        <p class="text-slate-200 leading-relaxed mb-4">
                            <span class="font-bold text-slate-100">Interface with external hardware</span> including analog sensors, digital outputs, and servo motors connected to your drone controller.
                        </p>
                        <p class="text-slate-200 leading-relaxed">
                            Read analog voltages from sensors, control GPIO pins, or drive servos for payload manipulation. Expand your drone's capabilities with custom hardware integrations.
                        </p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div class="info-card">
                            <h3 class="font-bold">Read ADC</h3>
                            <div class="pb-block block-peripherals">adc_read_x2</div>
                            <div><span class="label">Function</span><p class="text-body">Reads analog voltages (0-3.3V) as raw digital numbers.</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Distance sensor integration for obstacle avoidance, light intensity monitoring, environmental condition measurement, or custom sensor payload data acquisition.</p></div>
                        </div>
                        <div class="info-card">
                            <h3 class="font-bold">Digital Write</h3>
                            <div class="pb-block block-peripherals">set_peripheral_x2</div>
                            <div><span class="label">Function</span><p class="text-body">Sets a digital pin to HIGH (1) or LOW (0).</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">External relay control for high-power devices, warning beacon activation, landing gear deployment, or payload mechanism triggering.</p></div>
                        </div>
                        <div class="info-card md:col-span-2">
                            <h3 class="font-bold">Servo Control</h3>
                            <div class="pb-block block-peripherals">set_servo_x2</div>
                            <div><span class="label">Function</span><p class="text-body">Controls the angle of standard PWM servos.</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Payload delivery systems, mechanical gripper control, camera gimbal positioning, autonomous object manipulation, or precise mechanical actuation tasks.</p></div>
                        </div>
                    </div>
                </section>

                <!-- 5. Command -->
                <section id="Command">
                    <h2 class="text-3xl font-black text-sky-400 mb-10">5. Flight Command</h2>
                    
                    <div class="bg-gradient-to-r from-blue-950 to-slate-900 border border-blue-800 rounded-xl p-6 mb-12">
                        <p class="text-slate-200 leading-relaxed mb-4">
                            <span class="font-bold text-slate-100">Execute drone flight operations</span> including takeoff, landing, arming, and special movements to control your drone's behavior.
                        </p>
                        <p class="text-slate-200 leading-relaxed">
                            Send high-level commands to the flight controller for autonomous or triggered drone movements. These blocks form the foundation of your flight automation scripts.
                        </p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                        <div class="info-card">
                            <h3 class="font-bold">Take Off</h3>
                            <div class="pb-block block-command">take_off_x2</div>
                            <div><span class="label">Function</span><p class="text-body">Launches drone to automated height.</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Scheduled launch sequences with controlled delay intervals, autonomous mission initiation, or trigger-based flight launches.</p></div>
                        </div>
                        <div class="info-card">
                            <h3 class="font-bold">Land</h3>
                            <div class="pb-block block-command">land_x2</div>
                            <div><span class="label">Function</span><p class="text-body">Triggers a stable descent.</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Emergency landing procedures on low battery, auto-landing at mission completion, or failsafe descent on signal loss.</p></div>
                        </div>
                        <div class="info-card">
                            <h3 class="font-bold">Arm</h3>
                            <div class="pb-block block-command">arm_x2</div>
                            <div><span class="label">Function</span><p class="text-body">Enables motor power.</p></div>
                        </div>
                        <div class="info-card">
                            <h3 class="font-bold">Flip</h3>
                            <div class="pb-block block-command">flip_x2</div>
                            <div><span class="label">Function</span><p class="text-body">360-degree backflip trick.</p></div>
                        </div>
                        <div class="info-card border-l-4 border-l-red-500">
                            <h3 class="font-bold text-red-600">Disarm</h3>
                            <div class="pb-block" style="background-color: #ef4444;">disarm_x2</div>
                            <div><span class="label">Function</span><p class="text-body">Instant motor kill-switch.</p></div>
                            <div class="use-case-box"><span class="label">Where to use</span><p class="text-body italic">Stop motors immediately if "is_crashed_x2" is True.</p></div>
                        </div>
                    </div>
                </section>

                <!-- 6. Motor -->
                <section id="Motor">
                    <h2 class="text-3xl font-black text-sky-400 mb-10">6. Motor Drive</h2>
                    
                    <div class="bg-gradient-to-r from-blue-950 to-slate-900 border border-blue-800 rounded-xl p-6 mb-12">
                        <p class="text-slate-200 leading-relaxed mb-4">
                            <span class="font-bold text-slate-100">Control individual motors</span> on your drone for precise thrust and direction management across all motor ports.
                        </p>
                        <p class="text-slate-200 leading-relaxed">
                            Set motor speeds for bi-directional ground movement or propeller thrust values for flight. Useful for testing, balancing, and advanced manual flight stabilization.
                        </p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                        <div class="info-card">
                            <h3 class="font-bold">Motor M1</h3>
                            <div class="pb-block block-motor">set_m1_x2</div>
                            <div><span class="label">Function</span><p class="text-body">Reversible motor (1000-2000 PWM).</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Autonomous ground rover locomotion with precise bi-directional movement control or mechanical landing gear actuation during flight sequences.</p></div>
                        </div>
                        <div class="info-card">
                            <h3 class="font-bold">Motor M2</h3>
                            <div class="pb-block block-motor">set_m2_x2</div>
                            <div><span class="label">Function</span><p class="text-body">Reversible motor (1000-2000 PWM).</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Automated cargo bay door sequencing, retractable payload mechanisms, or remote-controlled mechanical actuator management.</p></div>
                        </div>
                        <div class="info-card">
                            <h3 class="font-bold">Motor M3</h3>
                            <div class="pb-block block-motor">set_m3_x2</div>
                            <div><span class="label">Function</span><p class="text-body">Reversible motor (1000-2000 PWM).</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Multi-axis camera gimbal stabilization, 360-degree payload rotation control, or sensor alignment adjustment during autonomous flight.</p></div>
                        </div>
                        <div class="info-card">
                            <h3 class="font-bold">Motor M4</h3>
                            <div class="pb-block block-motor">set_m4_x2</div>
                            <div><span class="label">Function</span><p class="text-body">Reversible motor (1000-2000 PWM).</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Automated winch and pulley systems for lift operations, secondary payload deployment/retrieval, or mechanical load control.</p></div>
                        </div>
                        <div class="info-card">
                            <h3 class="font-bold">Motor M5</h3>
                            <div class="pb-block block-motor">set_m5_x2</div>
                            <div><span class="label">Function</span><p class="text-body">Propeller thrust (1000-2000 PWM).</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Individual propeller performance testing, thrust balancing verification, or asymmetric flight pattern generation.</p></div>
                        </div>
                        <div class="info-card">
                            <h3 class="font-bold">Motor M6</h3>
                            <div class="pb-block block-motor">set_m6_x2</div>
                            <div><span class="label">Function</span><p class="text-body">Propeller thrust (1000-2000 PWM).</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Motor response curve tuning, connectivity verification, or differential thrust maneuvers for advanced flight control.</p></div>
                        </div>
                        <div class="info-card">
                            <h3 class="font-bold">Motor M7</h3>
                            <div class="pb-block block-motor">set_m7_x2</div>
                            <div><span class="label">Function</span><p class="text-body">Propeller thrust (1000-2000 PWM).</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Emergency descent activation, safety cutoff mechanisms, or controlled emergency landing procedures.</p></div>
                        </div>
                        <div class="info-card">
                            <h3 class="font-bold">Motor M8</h3>
                            <div class="pb-block block-motor">set_m8_x2</div>
                            <div><span class="label">Function</span><p class="text-body">Propeller thrust (1000-2000 PWM).</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Real-time flight stabilization, asymmetric thrust compensation, or aerodynamic load balancing during dynamic maneuvers.</p></div>
                        </div>
                    </div>
                </section>

                <!-- 7. Remote Control -->
                <section id="Remote">
                    <h2 class="text-3xl font-black text-sky-400 mb-10">7. Remote Control</h2>
                    
                    <div class="bg-gradient-to-r from-blue-950 to-slate-900 border border-blue-800 rounded-xl p-6 mb-12">
                        <p class="text-slate-200 leading-relaxed mb-4">
                            <span class="font-bold text-slate-100">Read and override remote control inputs</span> from your transmitter or create programmatic flight control overrides.
                        </p>
                        <p class="text-slate-200 leading-relaxed">
                            Monitor stick positions, trigger actions based on user input, or implement autopilot features by overriding RC channels with software-controlled values.
                        </p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div class="info-card">
                            <h4 class="font-bold">Read Stick Position</h4>
                            <div class="pb-block block-remote">rc_roll_x2</div>
                            <div><span class="label">Function</span><p class="text-body">Reads raw joystick value (1000-2000).</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Gesture-based flight command detection, advanced manual control response logic, or transmitter input analysis for trick activation.</p></div>
                        </div>
                        <div class="info-card">
                            <h4 class="font-bold">Set Control Value</h4>
                            <div class="pb-block block-remote">set_pitch_x2</div>
                            <div><span class="label">Function</span><p class="text-body">Overrides stick inputs with software values.</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Autonomous flight path execution, augmented reality drone control, or programmatic RC override for hybrid manual-autonomous missions.</p></div>
                        </div>
                    </div>
                </section>

                <!-- 8. Sensor -->
                <section id="Sensor">
                    <h2 class="text-3xl font-black text-sky-400 mb-10">8. Sensor Data</h2>
                    
                    <div class="bg-gradient-to-r from-blue-950 to-slate-900 border border-blue-800 rounded-xl p-6 mb-12">
                        <p class="text-slate-200 leading-relaxed mb-4">
                            <span class="font-bold text-slate-100">Access raw sensor data</span> from your drone's IMU, accelerometer, gyroscope, and battery management system for custom logic.
                        </p>
                        <p class="text-slate-200 leading-relaxed">
                            Read acceleration forces, rotational rates, magnetic heading, battery voltage, and health status to make intelligent decisions about flight safety, duration, and performance optimization.
                        </p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                        <div class="info-card">
                            <h3 class="font-bold">Accelerometer X/Y/Z</h3>
                            <div class="pb-block block-sensor">get_acc_x2</div>
                            <div><span class="label">Function</span><p class="text-body">Linear acceleration in G-forces on selected axis.</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Impact-triggered safety responses, gesture-based flight control through throw-to-launch detection, or flight intensity monitoring for maneuver analysis.</p></div>
                        </div>
                        <div class="info-card">
                            <h3 class="font-bold">Gyroscope X/Y/Z</h3>
                            <div class="pb-block block-sensor">get_gyro_x2</div>
                            <div><span class="label">Function</span><p class="text-body">Rotational velocity (degrees per second) on selected axis.</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Spin rate-triggered actions, rotation speed monitoring for acrobatic maneuvers, or angular velocity-based flight behavior modification.</p></div>
                        </div>
                        <div class="info-card">
                            <h3 class="font-bold">Magnetometer Heading</h3>
                            <div class="pb-block block-sensor">get_mag_x2</div>
                            <div><span class="label">Function</span><p class="text-body">Compass heading (0-360 degrees).</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Autonomous waypoint navigation, compass-based return-to-home functionality, or cardinal direction-aware mission planning.</p></div>
                        </div>
                        <div class="info-card">
                            <h3 class="font-bold">Battery Voltage</h3>
                            <div class="pb-block block-sensor">battery_voltage_x2</div>
                            <div><span class="label">Function</span><p class="text-body">Returns raw battery cell voltage (mV).</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Real-time battery health monitoring, voltage-triggered failsafe procedures, or flight-time estimation based on remaining cell voltage.</p></div>
                        </div>
                        <div class="info-card">
                            <h3 class="font-bold">Battery Health</h3>
                            <div class="pb-block block-sensor">battery_health_x2</div>
                            <div><span class="label">Function</span><p class="text-body">Battery percentage (0-100%) and cycle count.</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Predictive battery life calculation, charge cycle monitoring for maintenance alerts, or health-based mission planning constraints.</p></div>
                        </div>
                        <div class="info-card">
                            <h3 class="font-bold">Temperature Sensor</h3>
                            <div class="pb-block block-sensor">get_temp_x2</div>
                            <div><span class="label">Function</span><p class="text-body">Internal controller temperature (Â°C).</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Thermal throttling safety protocols, CPU overheat detection with visual/audio warnings, or temperature-based mission abort procedures.</p></div>
                        </div>
                    </div>
                </section>

                <!-- 9. Current State -->
                <section id="State">
                    <h2 class="text-3xl font-black text-sky-400 mb-10">9. Current State</h2>
                    
                    <div class="bg-gradient-to-r from-blue-950 to-slate-900 border border-blue-800 rounded-xl p-6 mb-12">
                        <p class="text-slate-200 leading-relaxed mb-4">
                            <span class="font-bold text-slate-100">Monitor your drone's real-time state</span> including attitude angles, altitude, and position data from the flight controller.
                        </p>
                        <p class="text-slate-200 leading-relaxed">
                            Access roll, pitch, yaw, and altitude readings to implement stabilization logic, altitude ceilings, or feedback-based autonomous flight routines.
                        </p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                        <div class="info-card">
                            <h3 class="font-bold">Orientation Angles</h3>
                            <div class="pb-block block-state">current_roll_x2</div>
                            <div><span class="label">Function</span><p class="text-body">Real-time attitude in degrees.</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Precision attitude maintenance for level flight, acrobatic maneuver verification, or feedback-based stability control algorithms.</p></div>
                        </div>
                        <div class="info-card">
                            <h3 class="font-bold">Current Height</h3>
                            <div class="pb-block block-state">current_height_x2</div>
                            <div><span class="label">Function</span><p class="text-body">Altitude relative to takeoff (cm).</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Altitude ceiling enforcement, terrain-aware autonomous flight, or altitude-triggered mission phase transitions.</p></div>
                        </div>
                    </div>
                </section>

                <!-- 10. Desired State -->
                <section id="Desired">
                    <h2 class="text-3xl font-black text-sky-400 mb-10">10. Desired State</h2>
                    
                    <div class="bg-gradient-to-r from-blue-950 to-slate-900 border border-blue-800 rounded-xl p-6 mb-12">
                        <p class="text-slate-200 leading-relaxed mb-4">
                            <span class="font-bold text-slate-100">Set target flight angles</span> for your drone to reach specific orientations while the flight controller maintains stabilization.
                        </p>
                        <p class="text-slate-200 leading-relaxed">
                            Command desired pitch, roll, and yaw angles to create smooth automated flight patterns, circular movements, or precision positioning routines.
                        </p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div class="info-card">
                            <h4 class="font-bold">Set Target Angle</h4>
                            <div class="pb-block block-desired">desired_pitch_x2</div>
                            <div><span class="label">Function</span><p class="text-body">Commands flight controller to reach specific angle.</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Circular flight pattern generation, coordinated banking maneuvers, or precision angle-based autonomous flight routines.</p></div>
                        </div>
                    </div>
                </section>

                <!-- 11. Flight Mode -->
                <section id="Mode">
                    <h2 class="text-3xl font-black text-sky-400 mb-10">11. Flight Mode</h2>
                    
                    <div class="bg-gradient-to-r from-blue-950 to-slate-900 border border-blue-800 rounded-xl p-6 mb-12">
                        <p class="text-slate-200 leading-relaxed mb-4">
                            <span class="font-bold text-slate-100">Query active flight modes</span> to determine if your drone is operating in headfree mode or other specialized flight configurations.
                        </p>
                        <p class="text-slate-200 leading-relaxed">
                            Use flight mode information to trigger mode-specific behaviors or provide feedback through LEDs and other indicators.
                        </p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div class="info-card">
                            <h3 class="font-bold">Is Headfree?</h3>
                            <div class="pb-block block-mode">is_headfree_x2</div>
                            <div><span class="label">Function</span><p class="text-body">Checks if drone is in direction-relative mode.</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Mode-specific LED indicators, flight mode confirmation display, or mode-dependent behavior switching for dynamic flight control.</p></div>
                        </div>
                    </div>
                </section>

                <!-- 12. Flight Status -->
                <section id="Status">
                    <h2 class="text-3xl font-black text-sky-400 mb-10">12. Flight Status</h2>
                    
                    <div class="bg-gradient-to-r from-blue-950 to-slate-900 border border-blue-800 rounded-xl p-6 mb-12">
                        <p class="text-slate-200 leading-relaxed mb-4">
                            <span class="font-bold text-slate-100">Monitor critical drone status</span> including armed state, crash detection, and flight safety conditions.
                        </p>
                        <p class="text-slate-200 leading-relaxed">
                            Implement emergency handling, safety checks, and status-dependent behaviors. Build robust programs that respond to real-time operational state changes.
                        </p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                        <div class="info-card border-l-4 border-l-green-400">
                            <h4 class="font-bold">Is Armed?</h4>
                            <div class="pb-block block-status">is_armed_x2</div>
                            <div><span class="label">Function</span><p class="text-body">Returns True if motors are unlocked.</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Motor command safety gates, flight-ready status confirmation, or armed state dependent automation routines.</p></div>
                        </div>
                        <div class="info-card border-l-4 border-l-red-500">
                            <h4 class="font-bold">Crashed?</h4>
                            <div class="pb-block block-status">is_crashed_x2</div>
                            <div><span class="label">Function</span><p class="text-body">Returns True on heavy impact.</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Immediate motor cutoff on collision, impact-based emergency procedures, or crash recovery logging and notification.</p></div>
                        </div>
                        <div class="info-card border-l-4 border-l-yellow-500">
                            <h4 class="font-bold">Signal Loss?</h4>
                            <div class="pb-block block-status">signal_loss_x2</div>
                            <div><span class="label">Function</span><p class="text-body">Returns True if RC signal is disconnected.</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Failsafe landing sequences, loss-of-link recovery procedures, or signal restoration monitoring and alerts.</p></div>
                        </div>
                        <div class="info-card border-l-4 border-l-orange-500">
                            <h4 class="font-bold">Battery Low?</h4>
                            <div class="pb-block block-status">battery_low_x2</div>
                            <div><span class="label">Function</span><p class="text-body">Returns True when battery below threshold.</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Visual/audio battery warning systems, automatic return-to-home activation, or mission abort procedures on critical battery levels.</p></div>
                        </div>
                        <div class="info-card border-l-4 border-l-blue-500">
                            <h4 class="font-bold">Flying?</h4>
                            <div class="pb-block block-status">is_flying_x2</div>
                            <div><span class="label">Function</span><p class="text-body">Returns True if drone is airborne.</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Airborne-only command gating, aerial maneuver execution guards, or flight phase dependent behavior modifications.</p></div>
                        </div>
                    </div>
                </section>

                <!-- 13. Console -->
                <section id="Console">
                    <h2 class="text-3xl font-black text-sky-400 mb-10">13. Console</h2>
                    
                    <div class="bg-gradient-to-r from-blue-950 to-slate-900 border border-blue-800 rounded-xl p-6 mb-12">
                        <p class="text-slate-200 leading-relaxed mb-4">
                            <span class="font-bold text-slate-100">Debug and monitor your programs</span> by sending messages and sensor values to the Pluto Monitor application in real-time.
                        </p>
                        <p class="text-slate-200 leading-relaxed">
                            Track program flow, display live sensor data, and verify that your automation logic is executing correctly during flight tests.
                        </p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div class="info-card">
                            <h4 class="font-bold">Print Message</h4>
                            <div class="pb-block block-function">pluto_monitor_print_x2</div>
                            <div><span class="label">Function</span><p class="text-body">Sends text to the Pluto Monitor app.</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Real-time mission debugging, autonomous logic verification, or flight event logging for post-mission analysis.</p></div>
                        </div>
                        <div class="info-card">
                            <h4 class="font-bold">Print Text + Value</h4>
                            <div class="pb-block block-function">pluto_monitor_print_x2_var</div>
                            <div><span class="label">Function</span><p class="text-body">Shows a label with a live sensor number.</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Live sensor telemetry monitoring, variable state tracking during flight, or sensor data logging for performance optimization.</p></div>
                        </div>
                    </div>
                </section>

                <!-- 14. Logic -->
                <section id="Logic">
                    <h2 class="text-3xl font-black text-sky-400 mb-10">14. Logic</h2>
                    
                    <div class="bg-gradient-to-r from-blue-950 to-slate-900 border border-blue-800 rounded-xl p-6 mb-12">
                        <p class="text-slate-200 leading-relaxed mb-4">
                            <span class="font-bold text-slate-100">Create conditional decision-making</span> in your programs using if-then statements and logical operators.
                        </p>
                        <p class="text-slate-200 leading-relaxed">
                            Build intelligent automation by combining multiple conditions with AND, OR, and NOT operators to control complex flight behaviors.
                        </p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div class="info-card">
                            <h4 class="font-bold">If This, Then That</h4>
                            <div class="pb-block block-logic">controls_if</div>
                            <div><span class="label">Function</span><p class="text-body">Decision making block based on conditions.</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Conditional flight path planning, sensor-based autonomous decision making, or altitude-dependent thrust adjustments.</p></div>
                        </div>
                        <div class="info-card">
                            <h4 class="font-bold">Both True? (AND)</h4>
                            <div class="pb-block block-logic">logic_operation</div>
                            <div><span class="label">Function</span><p class="text-body">Combines two conditions.</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Complex multi-factor decision logic, failsafe condition combinations, or cooperative sensor-based automation triggers.</p></div>
                        </div>
                    </div>
                </section>

                <!-- 15. Loops -->
                <section id="Loops">
                    <h2 class="text-3xl font-black text-sky-400 mb-10">15. Loops</h2>
                    
                    <div class="bg-gradient-to-r from-blue-950 to-slate-900 border border-blue-800 rounded-xl p-6 mb-12">
                        <p class="text-slate-200 leading-relaxed mb-4">
                            <span class="font-bold text-slate-100">Repeat code blocks</span> using for loops and while loops to execute sequences multiple times without duplication.
                        </p>
                        <p class="text-slate-200 leading-relaxed">
                            Build repetitive flight patterns, pattern-based LED indicators, or condition-dependent flight sequences that run until specific criteria are met.
                        </p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div class="info-card">
                            <h4 class="font-bold">For Loop (Counter)</h4>
                            <div class="pb-block block-logic">controls_for</div>
                            <div><span class="label">Function</span><p class="text-body">Repeats an action for a specific count.</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Repetitive status indication patterns, sequential motor testing routines, or counted autonomous flight sequences.</p></div>
                        </div>
                        <div class="info-card">
                            <h4 class="font-bold">Repeat While</h4>
                            <div class="pb-block block-logic">controls_whileUntil</div>
                            <div><span class="label">Function</span><p class="text-body">Repeats code as long as a condition is met.</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Persistent condition monitoring, altitude-dependent motor control, or sensor-driven continuous operation loops.</p></div>
                        </div>
                    </div>
                </section>

                <!-- 16. Math -->
                <section id="Math">
                    <h2 class="text-3xl font-black text-sky-400 mb-10">16. Math</h2>
                    
                    <div class="bg-gradient-to-r from-blue-950 to-slate-900 border border-blue-800 rounded-xl p-6 mb-12">
                        <p class="text-slate-200 leading-relaxed mb-4">
                            <span class="font-bold text-slate-100">Perform mathematical operations</span> including clamping, rounding, random values, and other calculations.
                        </p>
                        <p class="text-slate-200 leading-relaxed">
                            Process sensor data, constrain control values to safe ranges, generate random patterns, or compute complex flight algorithms.
                        </p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="info-card">
                            <h4 class="font-bold">Clamp (Limit)</h4>
                            <div class="pb-block block-math">math_constrain</div>
                            <div><span class="label">Function</span><p class="text-body">Keeps a number inside a range.</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Motor control safety bounds enforcement, sensor value normalization, or command output range validation.</p></div>
                        </div>
                        <div class="info-card">
                            <h4 class="font-bold">Random Integer</h4>
                            <div class="pb-block block-math">math_random_int</div>
                            <div><span class="label">Function</span><p class="text-body">Picks a whole number randomly.</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Randomized flight patterns for coverage missions, stochastic behavior simulation, or non-deterministic autonomous routines.</p></div>
                        </div>
                        <div class="info-card">
                            <h4 class="font-bold">Round</h4>
                            <div class="pb-block block-math">math_round</div>
                            <div><span class="label">Function</span><p class="text-body">Removes decimals from a number.</p></div>
                        </div>
                    </div>
                </section>

                <!-- 17. Variables -->
                <section id="Variables">
                    <h2 class="text-3xl font-black text-sky-400 mb-10">17. Variables</h2>
                    
                    <div class="bg-gradient-to-r from-blue-950 to-slate-900 border border-blue-800 rounded-xl p-6 mb-12">
                        <p class="text-slate-200 leading-relaxed mb-4">
                            <span class="font-bold text-slate-100">Store and manage data</span> using variables to track values throughout your program's execution.
                        </p>
                        <p class="text-slate-200 leading-relaxed">
                            Create counters, store sensor readings, track state information, and build dynamic flight logic that adapts based on stored data values.
                        </p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div class="info-card">
                            <h4 class="font-bold">Store Data</h4>
                            <div class="pb-block block-var">set_intVariable_to</div>
                            <div><span class="label">Function</span><p class="text-body">Creates a temporary memory to hold a number.</p></div>
                            <div class="use-case-box"><span class="label">Project Ideas</span><p class="text-body">Flight reference point tracking, mission state persistence, or historical data logging for performance analysis and recovery sequences.</p></div>
                        </div>
                    </div>
                </section>

            </div>

            <footer class="bg-slate-900 border-t border-slate-700 py-12 px-6 lg:px-12 text-center">
                <p class="text-xs text-slate-500">&copy; 2026 Drona Aviation.</p>
            </footer>
        </main>
    </div>

    <script>
        // --- 1. LOCAL MODULE LOADING ---
  // Uses the local @electron folder you'll bundle in the ZIP
  const remoteRendererPath = './@electron/remote/dist/src/renderer/remote.js';
  const { BrowserWindow: RemoteBrowserWindow, app: remoteApp } = require(remoteRendererPath);

  const path = require('path');
  const fs = require('fs');

  // --- 2. PATH RESOLUTION ---
  const appPathArg = window.process.argv.find(arg => arg.startsWith('--appPath='));
  const appRoot = appPathArg ? appPathArg.split('=')[1] : '';

  // Use the unified updater in your main installation's src folder
  const updaterPath = path.join(appRoot, 'src', 'docUpdater.js'); 
  const { syncGuideBook, guideCacheDir } = require(updaterPath);

  // --- 3. VERSION DISPLAY ---
  function displayCurrentVersion() {
    if (!guideCacheDir) return;
    const versionPath = path.join(guideCacheDir, 'version.json');
    // Note: You might want to add <div id="guide-version"></div> to your header
    const versionEl = document.getElementById('guide-version'); 
    
    try {
      if (fs.existsSync(versionPath)) {
        const data = JSON.parse(fs.readFileSync(versionPath, 'utf8'));
        if (versionEl) versionEl.textContent = `V4 MANUAL: ${data.tag}`;
      }
    } catch (e) { console.error("Version check failed", e); }
  }

  // --- 4. BACKGROUND SYNC LOGIC ---
  (async () => {
    console.log("[Guide-Book] Checking for technical updates...");
    displayCurrentVersion();
    try {
      const updated = await syncGuideBook();
      if (updated) {
        console.log("[Guide-Book] New technical manual downloaded to AppData.");
      }
    } catch (e) {
      console.warn("[Guide-Book] Update check failed:", e.message);
    }
  })();
        const menuBtn = document.getElementById('menuBtn');
        const sidebar = document.getElementById('sidebar');
        let isManualScrolling = false;
        let scrollTimeout;

        menuBtn.addEventListener('click', () => {
            sidebar.classList.toggle('-translate-x-full');
        });

        document.querySelectorAll('.sidebar-item').forEach(link => {
            link.addEventListener('click', (e) => {
                isManualScrolling = true;
                clearTimeout(scrollTimeout);

                document.querySelectorAll('.sidebar-item').forEach(li => li.classList.remove('active'));
                link.classList.add('active');

                if(window.innerWidth < 1024) sidebar.classList.add('-translate-x-full');

                scrollTimeout = setTimeout(() => {
                    isManualScrolling = false;
                }, 1000); 
            });
        });

        // Precise Observer with adjusted margins for standard screen sizes
        const observerOptions = {
            root: null,
            rootMargin: '-10% 0px -85% 0px', 
            threshold: 0
        };

        const observer = new IntersectionObserver((entries) => {
            if (isManualScrolling) return;

            const visible = entries.filter(e => e.isIntersecting);
            if (visible.length > 0) {
                // Find the entry with the smallest absolute top offset
                const closest = visible.reduce((prev, curr) => {
                    return (Math.abs(curr.boundingClientRect.top) < Math.abs(prev.boundingClientRect.top) ? curr : prev);
                });

                const id = closest.target.getAttribute('id');
                document.querySelectorAll('.sidebar-item').forEach(link => {
                    link.classList.toggle('active', link.getAttribute('href') === `#${id}`);
                });
            }
        }, observerOptions);

        document.querySelectorAll('section').forEach(section => observer.observe(section));
    </script>
</body>
</html>